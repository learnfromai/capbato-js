Page Display and Initialization:
WHEN a user navigates to the appointments page 
THE SYSTEM SHALL display the appointments page with header navigation, sidebar menu, main content area, and appointment table

WHEN the appointments page loads 
THE SYSTEM SHALL set the date input to today's date and automatically load today's appointments

WHEN the appointments page loads 
THE SYSTEM SHALL display user role and username in the header with profile avatar containing first letter of username

WHEN the appointments page loads 
THE SYSTEM SHALL highlight the "Appointments" menu item as active in the sidebar navigation

---

Navigation and User Interface:
WHEN a user clicks on any sidebar navigation item (Dashboard, Patients, Laboratory, Prescriptions, Doctors)
THE SYSTEM SHALL navigate to the corresponding page

WHEN a user with admin role accesses the appointments page 
THE SYSTEM SHALL dynamically add "Accounts" menu item to the sidebar navigation

WHEN a user clicks the profile avatar 
THE SYSTEM SHALL display dropdown menu with "Settings" and "Logout" options

WHEN a user clicks "Logout" in the profile dropdown 
THE SYSTEM SHALL clear localStorage authentication data and redirect to login page

WHEN a user clicks outside the profile dropdown 
THE SYSTEM SHALL close the dropdown menu

---

Appointment Filtering and Display:
WHEN the appointments page loads 
THE SYSTEM SHALL display appointments for today's date in a table with columns: Patient #, Patient Name, Reason for Visit, Date, Time, Doctor, Status, Action

WHEN a user changes the date in the date picker 
THE SYSTEM SHALL uncheck "Show All" checkbox and load appointments for the selected date

WHEN a user checks the "Show All" checkbox 
THE SYSTEM SHALL load all appointments sorted from latest to oldest by date and time

WHEN a user unchecks the "Show All" checkbox 
THE SYSTEM SHALL reload appointments for the currently selected date

WHEN appointments are displayed 
THE SYSTEM SHALL show appointment count with breakdown of confirmed and cancelled appointments

WHEN no appointments are found for today 
THE SYSTEM SHALL display "No upcoming appointments for today." message

WHEN no appointments are found for other dates 
THE SYSTEM SHALL display "No appointments found." message

---

Add Appointment Functionality:
WHEN a user clicks the "Add Appointment" button 
THE SYSTEM SHALL display overlay with iframe containing add appointment form

WHEN the add appointment overlay opens 
THE SYSTEM SHALL reset the form and clear any previous data

WHEN a user clicks the close button on the overlay 
THE SYSTEM SHALL close the overlay and clear the iframe source

WHEN an appointment is successfully added 
THE SYSTEM SHALL close the overlay, show success toast notification, and refresh appointments table

WHEN an appointment is added with a specific date 
THE SYSTEM SHALL set the date picker to that date, uncheck "Show All", and display appointments for that date

---

Appointment Management Actions:
WHEN an appointment has "Confirmed" status 
THE SYSTEM SHALL display "Modify" and "Cancel" action buttons

WHEN an appointment has "Cancelled" status 
THE SYSTEM SHALL display "Reconfirm" action button

WHEN a user clicks "Modify" button 
THE SYSTEM SHALL open appointment overlay with form pre-filled with existing appointment data

WHEN a user clicks "Cancel" button 
THE SYSTEM SHALL display confirmation modal asking "Are you sure you want to cancel this appointment?"

WHEN a user confirms appointment cancellation 
THE SYSTEM SHALL update appointment status to "Cancelled", show success toast, and refresh appointments table

WHEN a user clicks "Reconfirm" button and time slot has available capacity (less than 4 confirmed appointments)
THE SYSTEM SHALL display confirmation modal asking "Reconfirm this appointment?"

WHEN a user clicks "Reconfirm" button and time slot is fully booked (4 confirmed appointments)
THE SYSTEM SHALL open appointment form overlay for rescheduling to a different time

WHEN a user confirms appointment reconfirmation 
THE SYSTEM SHALL update appointment status to "Confirmed", show success toast, and refresh appointments table

---

Form Validation and User Feedback:
WHEN appointment operations encounter errors 
THE SYSTEM SHALL display error messages via toast notifications

WHEN appointments table fails to load 
THE SYSTEM SHALL display "Error loading appointments." message in the table

WHEN appointment operations are successful 
THE SYSTEM SHALL display appropriate success messages via toast notifications

WHEN toast notifications are displayed 
THE SYSTEM SHALL automatically hide them after 2 seconds

WHEN confirmation modals are displayed 
THE SYSTEM SHALL provide "Yes" and "No" buttons for user confirmation

---

Authentication and Authorization:
WHEN the appointments page loads 
THE SYSTEM SHALL retrieve and display logged-in user's role and username from localStorage

WHEN user authentication data is not present 
THE SYSTEM SHALL redirect user to login page

WHEN a user logs out 
THE SYSTEM SHALL clear all authentication data from localStorage and redirect to login page

---

Data Loading and Error Handling:
WHEN loading appointments from the server 
THE SYSTEM SHALL make HTTP GET request to "/appointments" endpoint

WHEN updating appointment status 
THE SYSTEM SHALL make HTTP PUT request to "/appointments/cancel/{id}" endpoint with new status

WHEN appointment operations fail due to network or server errors 
THE SYSTEM SHALL display error messages and maintain current table state

WHEN appointment operations succeed 
THE SYSTEM SHALL refresh appointments table based on current filter settings (date or show all)

---

Visual Design and Status Display:
WHEN appointments are displayed in the table 
THE SYSTEM SHALL format patient names in proper case (first letter capitalized)

WHEN appointments are displayed in the table 
THE SYSTEM SHALL format time in 12-hour format with AM/PM

WHEN appointments are displayed in the table 
THE SYSTEM SHALL format dates in readable format (Month Day, Year)

WHEN appointment status is "Confirmed" 
THE SYSTEM SHALL display status with green background color

WHEN appointment status is "Cancelled" 
THE SYSTEM SHALL display status with red background color

WHEN the profile avatar is displayed 
THE SYSTEM SHALL generate consistent color based on username hash for visual identification