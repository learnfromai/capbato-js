Page Load and Authentication:
WHEN a user navigates to the dashboard page (index.html)
THE SYSTEM SHALL display the user's role and username in the header area if authentication data exists in localStorage

WHEN the dashboard page loads
THE SYSTEM SHALL set the page title to "M.G. Amores Medical Clinic"

---

Header Display and Profile Management:
WHEN the dashboard page loads
THE SYSTEM SHALL display a fixed header with clinic logo, clinic name "M.G. Amores Medical Clinic", user role, username, and profile avatar

WHEN the dashboard displays user information
THE SYSTEM SHALL show the user role with first letter capitalized and username below it in the header area

WHEN the dashboard creates a profile avatar
THE SYSTEM SHALL generate initials from the username and assign a consistent color based on username hash

WHEN a user clicks on the profile avatar
THE SYSTEM SHALL toggle a dropdown menu with "Settings" and "Logout" options

WHEN a user clicks outside the profile dropdown
THE SYSTEM SHALL close the dropdown menu

WHEN a user selects "Settings" from the profile dropdown
THE SYSTEM SHALL display "Settings functionality coming soon!" alert and close the dropdown

WHEN a user selects "Logout" from the profile dropdown
THE SYSTEM SHALL clear localStorage authentication data and redirect to login.html

---

Sidebar Navigation:
WHEN the dashboard page loads
THE SYSTEM SHALL display a fixed sidebar with navigation menu items for Dashboard, Appointments, Patients, Laboratory, Prescriptions, and Doctors

WHEN the current page is the dashboard
THE SYSTEM SHALL highlight the Dashboard menu item as active with special styling

WHEN a user is logged in as an admin
THE SYSTEM SHALL add an "Accounts" menu item to the sidebar navigation

WHEN a user hovers over any sidebar menu item
THE SYSTEM SHALL change the styling to indicate hover state

WHEN a user clicks on any sidebar menu item
THE SYSTEM SHALL navigate to the corresponding page

---

Summary Cards Display:
WHEN the dashboard page loads
THE SYSTEM SHALL display three summary cards showing Doctor, Current Patient, and Total Appointments

WHEN displaying the doctor card
THE SYSTEM SHALL show "Dr. Smith (Assigned)" with doctor icon and "Assigned" label

WHEN displaying the current patient card
THE SYSTEM SHALL fetch and show the name of the patient with appointment time closest to and before the current time or "N/A" if none

WHEN calculating the current patient fails
THE SYSTEM SHALL display "Error" in the Current Patient card

WHEN displaying the total appointments card
THE SYSTEM SHALL show the count of confirmed appointments for today with today's date in DD MMM YYYY format

---

Today's Appointments Table Display:
WHEN the dashboard page loads
THE SYSTEM SHALL display a "Today's Appointments" table with columns for Patient #, Patient, Reason for visit, Contact, Time, Doctor, and Status

WHEN loading today's appointments
THE SYSTEM SHALL fetch appointment data from the API and filter to show only appointments with times at or after the current time

WHEN displaying appointment times
THE SYSTEM SHALL format times in 12-hour format with AM/PM notation

WHEN displaying patient names
THE SYSTEM SHALL format names with proper capitalization (first letter of each word capitalized)

WHEN displaying patient names in the appointments table
THE SYSTEM SHALL make each patient name a clickable link to patientinfo.html with patient_id parameter

WHEN the appointments table is empty
THE SYSTEM SHALL display an empty table with headers visible

WHEN the appointments table is displayed
THE SYSTEM SHALL include a "See All" link at the bottom to navigate to appointments.html

---

Lab Results Display (Doctor Role Only):
WHEN a user is logged in as a doctor
THE SYSTEM SHALL display a "Today's Lab Test Results" table below the appointments table

WHEN a user is not logged in as a doctor
THE SYSTEM SHALL hide the lab results section entirely

WHEN loading lab test results for doctors
THE SYSTEM SHALL fetch completed lab tests and filter to show only tests completed today

WHEN displaying lab test results
THE SYSTEM SHALL show columns for Patient #, Patient Name, Lab Test, Date, Status, and Action

WHEN there are no lab test results for today
THE SYSTEM SHALL display "No completed lab tests for today" message in the table

WHEN there are lab test results to display
THE SYSTEM SHALL format patient names with proper capitalization and dates in MMM DD, YYYY format

WHEN displaying lab test patient names
THE SYSTEM SHALL make each patient name a clickable link to patientinfo.html with patient_id parameter

WHEN displaying lab test action buttons
THE SYSTEM SHALL show a "View" button with an eye icon for each completed test

WHEN a doctor clicks the "View" button for a lab test
THE SYSTEM SHALL open a modal overlay displaying the detailed lab test results in an iframe

WHEN the lab results table is displayed
THE SYSTEM SHALL include a "See All" link at the bottom to navigate to laboratory.html

---

Lab Results Modal Functionality:
WHEN a doctor clicks to view lab test results
THE SYSTEM SHALL open a modal overlay with iframe displaying the appropriate lab test form

WHEN opening the lab test modal
THE SYSTEM SHALL determine the correct form type based on the test type and load the corresponding HTML form

WHEN the lab test modal is displayed
THE SYSTEM SHALL show a close button (X) in the top-right corner of the modal

WHEN a user clicks the close button or clicks outside the modal
THE SYSTEM SHALL close the lab test modal and clear the iframe source

WHEN the Escape key is pressed while the modal is open
THE SYSTEM SHALL close the lab test modal

WHEN the lab test modal loads a form
THE SYSTEM SHALL send the lab test data to the iframe via postMessage for display in read-only mode

WHEN the lab test form sends a closeLabOverlay message
THE SYSTEM SHALL close the modal and refresh lab results if data was updated

---

Data Refresh and Real-time Updates:
WHEN the dashboard page is active
THE SYSTEM SHALL automatically refresh appointments data every 10 seconds

WHEN the dashboard page is active
THE SYSTEM SHALL automatically refresh current patient information every 10 seconds

WHEN the dashboard page is active and user is a doctor
THE SYSTEM SHALL automatically refresh lab test results every 30 seconds

WHEN any data refresh occurs
THE SYSTEM SHALL update the display without requiring user interaction or page reload

WHEN data fetching fails
THE SYSTEM SHALL log errors to console and maintain existing display data

---

Error Handling and User Feedback:
WHEN API calls fail for appointment data
THE SYSTEM SHALL log errors to console and display "Error" in the current patient field

WHEN API calls fail for lab results data
THE SYSTEM SHALL display "Error loading lab results" message in the lab results table

WHEN appointment data fails to load
THE SYSTEM SHALL display an empty appointments table without breaking the page layout

WHEN lab test data cannot be loaded for viewing
THE SYSTEM SHALL display "Error loading lab test data" alert message

---

Navigation and User Interactions:
WHEN patient links are clicked in any table
THE SYSTEM SHALL navigate to patientinfo.html with the correct patient_id parameter

WHEN "See All" links are clicked
THE SYSTEM SHALL navigate to the corresponding full page (appointments.html or laboratory.html)

WHEN any interactive element is hovered
THE SYSTEM SHALL provide visual feedback through styling changes

WHEN date and time information is displayed
THE SYSTEM SHALL use consistent formatting throughout the dashboard

---

Responsive Design and Styling:
WHEN the dashboard is displayed
THE SYSTEM SHALL maintain usable layout with proper spacing and alignment

WHEN tables contain long text content
THE SYSTEM SHALL handle text overflow while maintaining table structure

WHEN cards and tables are displayed
THE SYSTEM SHALL apply consistent styling with proper shadows and border radius

WHEN status information is displayed
THE SYSTEM SHALL use appropriate color coding and badge styling

WHEN interactive elements are displayed
THE SYSTEM SHALL provide appropriate hover effects and cursor pointer styling