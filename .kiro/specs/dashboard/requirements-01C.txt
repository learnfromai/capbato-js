Page Load and Authentication Validation:
WHEN a user navigates to the dashboard page (index.html)
THE SYSTEM SHALL validate authentication status and redirect to login page if not authenticated

WHEN the dashboard page loads for an authenticated user
THE SYSTEM SHALL display the header navbar with clinic logo, name, and user profile information

WHEN the dashboard page loads
THE SYSTEM SHALL set the page title to "M.G. Amores Medical Clinic"

---

User Profile Display and Management:
WHEN the dashboard loads for an authenticated user
THE SYSTEM SHALL display the user's role (Admin, Doctor, Receptionist) in the header with proper capitalization

WHEN the dashboard loads for an authenticated user  
THE SYSTEM SHALL display the username in the header below the role

WHEN the dashboard loads for an authenticated user
THE SYSTEM SHALL generate and display profile avatar with user initials and random color based on username

WHEN a user clicks on the profile avatar
THE SYSTEM SHALL show a dropdown menu with "Settings" and "Logout" options

WHEN a user clicks "Settings" in the profile dropdown
THE SYSTEM SHALL display "Settings functionality coming soon!" alert and close the dropdown

WHEN a user clicks "Logout" in the profile dropdown
THE SYSTEM SHALL clear all authentication data from localStorage and redirect to login page

WHEN a user clicks outside the profile dropdown
THE SYSTEM SHALL close the dropdown menu

---

Sidebar Navigation:
WHEN the dashboard loads
THE SYSTEM SHALL display a fixed sidebar with navigation items: Dashboard, Appointments, Patients, Laboratory, Prescriptions, and Doctors

WHEN the dashboard loads for an admin user
THE SYSTEM SHALL add "Accounts" navigation item to the sidebar

WHEN the dashboard loads 
THE SYSTEM SHALL mark the "Dashboard" navigation item as active with visual highlighting

WHEN a user clicks any sidebar navigation item
THE SYSTEM SHALL navigate to the corresponding page

WHEN a user hovers over a sidebar navigation item
THE SYSTEM SHALL show hover effect with color change and visual feedback

---

Summary Cards Display:
WHEN the dashboard loads
THE SYSTEM SHALL display three summary cards: Doctor, Current Patient, and Total Appointments

WHEN the dashboard loads
THE SYSTEM SHALL fetch and display the assigned doctor for the day in the Doctor card with "Dr. N/A" as default

WHEN the dashboard loads
THE SYSTEM SHALL fetch and display the current patient based on closest appointment time with "N/A" as default

WHEN the dashboard loads
THE SYSTEM SHALL fetch and display today's total confirmed appointments count with "0" as default

WHEN the dashboard loads
THE SYSTEM SHALL display today's date in DD MMM YYYY format in the Total Appointments card

---

Today's Appointments Table:
WHEN the dashboard loads
THE SYSTEM SHALL display "Today's Appointments" table with columns: Patient #, Patient, Reason for visit, Contact, Time, Doctor, Status

WHEN the dashboard loads
THE SYSTEM SHALL fetch and display appointments for today that are scheduled at or after the current time

WHEN the dashboard loads
THE SYSTEM SHALL format patient names with proper capitalization (first letter uppercase, rest lowercase)

WHEN the dashboard loads
THE SYSTEM SHALL format appointment times in 12-hour format with AM/PM

WHEN the dashboard loads
THE SYSTEM SHALL make patient names clickable links that navigate to patient information page

WHEN the dashboard loads
THE SYSTEM SHALL display "See All" link below the appointments table that navigates to appointments.html

WHEN no appointments are available for display
THE SYSTEM SHALL show empty table structure with headers

---

Auto-refresh Functionality:
WHEN the dashboard is displayed
THE SYSTEM SHALL automatically refresh appointment data every 10 seconds

WHEN the dashboard is displayed
THE SYSTEM SHALL automatically refresh current patient data every 10 seconds

WHEN the dashboard is displayed and user is a doctor
THE SYSTEM SHALL automatically refresh lab results data every 30 seconds

---

Lab Results Section (Doctor Role):
WHEN the dashboard loads for a doctor user
THE SYSTEM SHALL display "Today's Lab Test Results" section with table

WHEN the dashboard loads for a non-doctor user
THE SYSTEM SHALL hide the lab results section

WHEN the dashboard loads for a doctor
THE SYSTEM SHALL fetch and display completed lab tests for today with columns: Patient #, Patient Name, Lab Test, Date, Status, Action

WHEN the dashboard loads for a doctor
THE SYSTEM SHALL display "See All" link below lab results table that navigates to laboratory.html

WHEN completed lab tests are available for today
THE SYSTEM SHALL display each test with formatted patient name, date, and "View" button

WHEN no completed lab tests are available for today
THE SYSTEM SHALL display message "No completed lab tests for today" in the table

WHEN a doctor clicks "View" button for a lab test
THE SYSTEM SHALL open lab result overlay modal with the specific test form

---

Lab Results Modal Functionality:
WHEN a doctor clicks "View" button for a lab test
THE SYSTEM SHALL determine the correct lab form type based on the test name

WHEN the lab overlay modal opens
THE SYSTEM SHALL load the appropriate lab form (urinalysis, blood-chemistry, hematology, etc.) in an iframe

WHEN the lab overlay modal opens
THE SYSTEM SHALL display a close button (X) in the top-right corner

WHEN the lab form loads in the modal
THE SYSTEM SHALL send test data to the form for read-only display

WHEN a user clicks the close button in the lab modal
THE SYSTEM SHALL close the overlay and clear the iframe source

WHEN a user clicks outside the modal container
THE SYSTEM SHALL close the lab overlay modal

WHEN a user presses the Escape key while modal is open
THE SYSTEM SHALL close the lab overlay modal

WHEN the lab form sends close message from iframe
THE SYSTEM SHALL close the modal and refresh lab results if needed

---

Error Handling and User Feedback:
WHEN API calls fail for dashboard data
THE SYSTEM SHALL log errors to console and display fallback values

WHEN appointment data fails to load
THE SYSTEM SHALL display "Error" in the current patient field and show empty appointments table

WHEN lab results fail to load for doctors
THE SYSTEM SHALL display "Error loading lab results" message in the lab results table

WHEN current patient data fails to load
THE SYSTEM SHALL display "Error" in the current patient summary card

---

Responsive Design and User Experience:
WHEN the dashboard is displayed on smaller screens
THE SYSTEM SHALL maintain responsive layout with proper spacing and alignment

WHEN the dashboard loads
THE SYSTEM SHALL apply consistent styling with gradient background and proper font families

WHEN users interact with clickable elements
THE SYSTEM SHALL provide visual feedback through hover effects and transitions

WHEN the dashboard displays data
THE SYSTEM SHALL use consistent formatting for names, dates, and times across all sections

WHEN the dashboard loads
THE SYSTEM SHALL ensure proper z-index layering for modals, dropdowns, and fixed elements

---

Performance and Optimization:
WHEN the dashboard loads
THE SYSTEM SHALL initialize all event listeners and modal functionality without blocking the UI

WHEN auto-refresh intervals are active
THE SYSTEM SHALL efficiently update only the necessary DOM elements without full page refresh

WHEN the dashboard receives new data
THE SYSTEM SHALL update the display smoothly without causing layout shifts or flashing

WHEN multiple API calls are made
THE SYSTEM SHALL handle them asynchronously to maintain UI responsiveness